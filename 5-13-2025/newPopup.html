



<script>
    var groupIndiaAbout1 = ["BH", "IQ", "OM", "QA", "AE", "PS", "TN", "DZ", "MA"];
    var groupIndiaAbout2 = ["IN", "BD"];
    var groupIndiaAbout3 = ["PK", "JO", "KW", "SA", "EG"];
    var groupIndiaAbout4 = ["AF", "LB", "SY", "YE", "LY"];

    function isInIndiaGroup(countryCode) {
        return (
            groupIndiaAbout1.includes(countryCode) ||
            groupIndiaAbout2.includes(countryCode) ||
            groupIndiaAbout3.includes(countryCode) ||
            groupIndiaAbout4.includes(countryCode)
        );
    }

    var countryCodeChecker = localStorage.getItem("country_code");

    if (isInIndiaGroup(countryCodeChecker)) {
        $(".worldwidegov").remove();
        $(".indiagov").show();
    } else {
        $(".indiagov").remove();
        $(".worldwidegov").show();
    }

    let itemsDisplayed = 4;

    function renderEvents(selectedCountry, searchText = "") {
        $("#dom_section").empty();

        $.getJSON("https://cdn.learnwurks.com/assets/img/event_24/js/data5.json?version=5.0", function (data) {
            let count = 0;

            function parseDateString(dateStr) {
                return new Date(dateStr.replace(/(\d{1,2}) (\d{4})$/, ", $1 $2"));
            }

            let today = new Date();
            today.setHours(0, 0, 0, 0); // normalize to midnight

            let filteredEvents = data.filter(
                (event) =>
                    (selectedCountry === "all" || event.country.toLowerCase() === selectedCountry.toLowerCase()) &&
                    (searchText === "" || event.title.toLowerCase().includes(searchText.toLowerCase()))
            );

            // ✅ Split and sort properly
            let upcomingEvents = filteredEvents
                .filter((event) => parseDateString(event.date) >= today)
                .sort((a, b) => parseDateString(a.date) - parseDateString(b.date)); // soonest to latest

            let pastEvents = filteredEvents
                .filter((event) => parseDateString(event.date) < today)
                .sort((a, b) => parseDateString(b.date) - parseDateString(a.date)); // latest to oldest

            let sortedEvents = upcomingEvents.concat(pastEvents); // Upcoming first, then past

            $.each(sortedEvents, function (index, event) {
                if (count >= itemsDisplayed) return false;

                let descHtml = Array.isArray(event.desc)
                    ? event.desc.map((line) => `<p>${line}</p>`).join("")
                    : `<p>${event.desc}</p>`;

                let cardHtml = `<div class="card align-items-center custom-card-style">
          <img src="${event.image}" class="card-img-top" alt="Event Thumbnail">
          <div class="card-body body-custom">
            <h5 class="card-title title-custom">${event.title}</h5>
            <div class="desc-custom">${descHtml}</div>
          </div>
          <div class="row-second column">
            <small class="text-muted small-text-custom">${event.date}</small>
            <small class="text-muted small-text-custom">${event.time}</small>
            <div class="globe">${event.region_gmt}</div>
          </div>
          ${event.status === "Register Now"
                        ? `<div class="row-third column">
                <button class="btn btn-warning btn-custom-popup" data-title="${event.title}" data-desc="${event.desc}">More Info</button>
              </div>`
                        : event.statusBtn !== 'hide'
                            ? `<div class="row-third column">
                  <a href="${event.link}" target="_blank" class="btn btn-warning btn-custom-event">${event.status}</a>
                </div>` : ''}
        </div>`;

                $("#dom_section").append(cardHtml);
                count++;
            });

            if (count < itemsDisplayed || itemsDisplayed >= sortedEvents.length) {
                $("#load_more_btn").hide();
            } else {
                $("#load_more_btn").show();
            }

            //   $(".btn-custom-popup").click(function () {
            //     $("#modalBody").html(`
            //       <p>Join TradingHub Community on our Leadership Seminar and Kickoff event in Oslo on the 1st of March 2025. Monaxa is taking Scandinavia by storm!</p>
            //       <p>There will be workshop, keynote speakers and sharing of knowledge, experiences and strategies on how the community have chosen to learn and comprehend trading, while earning at the same time.</p>
            //       <p>We will share leadership skillsets like how to present as a leader, how you can build your organisation, sales and marketing strategies, and all the exciting news ahead!</p>
            //       <p>Our Keynote Speaker Mat Clarke, the Chief Investment Officer of Monaxa, will not only share some of the strategies he uses daily as a licensed institutional trader, but also how his journey in the trading space turned out to be. He will share how the innovative principles of Monaxa, the proactive team, and productive partners worldwide, will contribute to the paradigm shift we have already entered, in this information and technology revolution era our world is living in.</p>
            //       <p>Are you curious about how we as a community can stand together, no matter what level or experience we have, help each other, and be social together at TradingHub Meetups, home meetings, business planning sessions, and events?<br/>Where Knowledge, Technology, and Community are the three main focus areas and foundation of the whole community?</p>
            //       <p>Then this event is for you!</p>
            //       <p>Please go to our community app for program and tickets:</p>
            //       <br/>
            //       <a href="https://nas.io/tradinghub-community" target="_blank" class="btn btn-warning" style="background-color: #fad65a">Register Now</a>
            //       <br/><br/>
            //       <p>Goodie bag and Kickoff Dinner are included in the ticket price.</p>
            //       <p>We have a 7-day free trial to our community app, please use the code: <strong>7DAYSFREE</strong></p>
            //     `);
            //     $("#eventModal").modal("show");
            //   });
            // });

            // $(".btn-custom-popup").click(function () {
            //     const eventTitle = $(this).data("title");

            //     $("#modalBody").html(`
            //         <h5 style="color: red;">${eventTitle}</h5>
            //         <p style="color: red;">Join us at the first yearly FamilyTree Event of 2025 for a day of dynamic speakers, workshops, and networking. Take your journey to new heights and be inspired by industry leaders and captivating keynote speakers</p>
            //         <form method="POST">
            //         <input type="hidden" name="send_form" value="1">
            //         <div class="mb-3">
            //             <label class="form-label">Your Name</label>
            //             <input type="text" name="name" class="form-control" required>
            //         </div>
            //         <div class="mb-3">
            //             <label class="form-label">Your Email</label>
            //             <input type="email" name="email" class="form-control" required>
            //         </div>
            //         <button type="submit" class="btn btn-primary">Send</button>
            //         </form>
            //     `);
            //     $("#eventModal").modal("show");
            // });



            // $(".btn-custom-popup").on("click", function () {
    // $("#modalBody").html(`
    //     <form id="customForm">
    //         <div class="mb-3">
    //             <label>First Name</label>
    //             <input type="text" name="firstname" class="form-control" required>
    //         </div>
    //         <div class="mb-3">
    //             <label>Account Number</label>
    //             <input type="text" name="account_number" class="form-control" required>
    //         </div>
    //         <div class="mb-3">
    //             <label>Phone</label>
    //             <input type="tel" name="phone" class="form-control" required>
    //         </div>
    //         <div class="mb-3">
    //             <label>Email</label>
    //             <input type="email" name="email" class="form-control" required>
    //         </div>
    //         <div class="mb-3">
    //             <label>Category</label>
    //             <input type="text" name="category" class="form-control" required>
    //         </div>
    //         <div class="mb-3">
    //             <label>Details</label>
    //             <textarea name="details" class="form-control" required></textarea>
    //         </div>
    //         <button type="submit" class="btn btn-primary">Send</button>
    //     </form>
    //     <div id="response" class="mt-2"></div>
    // `);

    // $("#eventModal").modal("show");
});

// Handle form submit with custom dataString

        });
    }

// $(document).on("submit", "#smtp_form", function (e) {
    e.preventDefault(); // prevent form from refreshing the page

    const dataString = $(this).serialize();

    $.ajax({
        type: "POST",
        url: "https://monaxa.com/es/theme/Mnx/smtp.php",
        data: dataString,
        cache: false,
        success: function (result) {
            $("#response").html(`<div class="alert alert-success">✔ ${result}</div>`);
        },
        error: function (error) {
            $("#response").html(`<div class="alert alert-danger">✖ Error: Message not sent.</div>`);
            console.log(error);
        }
    });
});


$(document).on("submit", "#customForm", function (e) {
    e.preventDefault();

    // Collect values
    var firstname = $("input[name='firstname']").val();
    var account_number = $("input[name='account_number']").val();
    var phone = $("input[name='phone']").val();
    var email = $("input[name='email']").val();
    var category = $("input[name='category']").val();
    var details = $("textarea[name='details']").val();

    // Manually build the query string
    var dataString = 
        'firstname=' + encodeURIComponent(firstname) +
        '&account_number=' + encodeURIComponent(account_number) +
        '&phone=' + encodeURIComponent(phone) +
        '&email=' + encodeURIComponent(email) +
        '&category=' + encodeURIComponent(category) +
        '&details=' + encodeURIComponent(details);

    // Send via AJAX
    $.ajax({
        type: "POST",
        url: "https://monaxa.com/es/theme/Mnx/smtp.php",
        data: dataString,
        cache: false,
        success: function (result) {
            $("#response").html('<div class="alert alert-success">✔ ' + result + '</div>');
        },
        error: function (error) {
            $("#response").html('<div class="alert alert-danger">✖ Failed to send. Please try again.</div>');
            console.error(error);
        }
    });
});


  $("#load_more_btn").click(function (event) {
            event.preventDefault();
            itemsDisplayed += 4;
            let selectedCountry = $("#select_country").val() || "all";
            let searchText = $("#event_search").val();
            renderEvents(selectedCountry, searchText);
        });

        $("#select_country").on("change", function () {
            let selectedCountry = $(this).val();
            let searchText = $("#event_search").val();
            renderEvents(selectedCountry, searchText);
        });

        $("#event_search").on("input", function () {
            let searchText = $(this).val();
            let selectedCountry = $("#select_country").val() || "all";
            renderEvents(selectedCountry, searchText);
        });

        $(document).ready(function () {
            $("body").append(`
      <div class="modal fade" id="eventModal" tabindex="-1" aria-labelledby="modalTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="modalBody"></div>
          </div>
        </div>
      </div>
    `);
            renderEvents("all");
        });

    
</script>
